<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="{{ url_for('static', filename='js/jquery-3.6.0.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/accessibility.js') }}"></script>
    <script src="{{ url_for('static', filename='js/exporting.js') }}"></script>
    <script src="{{ url_for('static', filename='js/highcharts.js') }}"></script>
    <script src="{{ url_for('static', filename='js/drilldown.js') }}"></script>
    <link
      rel="stylesheet" type="text/css"
      href="{{ url_for('static', filename='css/styledashboard.css')}}"
    />
    <title>MET</title>
    <link rel="icon" href="{{ url_for('static', filename='images/automation1.png') }}" type="image/png">
  </head>
  <body>
    <div id="loading" class="loading-overlay hidden" >
      <img src="{{ url_for('static', filename='images/loading.gif') }}" alt="Loading..."/>
    </div>
    <div class="wrapper">
      <div id="coppyright"><a href="{{ url_for('index1') }}">¬©2025 Copyright MET-Automation | IOT</a></div>
      <nav id="navbar">
        <ul class="navbar-items flexbox-col">
          <li class="navbar-logo flexbox-left">
            <a class="navbar-item-inner flexbox" href="{{ url_for('index1') }}">
              <span class="logo"></span>
                <polygon points="925.79 318.48 830.56 0 183.51 1384.12 510.41 1178.46 925.79 318.48"/>
                <polygon points="1438.88 1663.28 1126.35 948.08 111.98 1586.26 0 1819.54 1020.91 1250.57 1123.78 1471.02 783.64 1663.28 1438.88 1663.28"/>
              </svg>
            </a>
          </li>
          <li class="navbar-item flexbox-left">
            <a class="navbar-item-inner flexbox-left" style="color: #fff;"  href="{{ url_for('dashboard_page') }}" >
              <div class="navbar-item-inner-icon-wrapper flexbox">
                <ion-icon name="search-outline"></ion-icon>
              </div>
              <div  class="link-text">
                <!-- <span class="nav-icon">üìä</span> -->
                <span class="nav-text">Dashboard Screw Force</span>
              </div>
            </a>
          </li>
          <li class="navbar-item flexbox-left">
            <a class="navbar-item-inner flexbox-left">
              <div class="navbar-item-inner-icon-wrapper flexbox">
                <ion-icon name="home-outline"></ion-icon>
              </div>
              <div class="link-text">
                <!-- <span class="nav-icon">üè†</span>  -->
                <span  class="nav-text">M·ª•c B</span>
              </div>
            </a>
          </li>
          <li class="navbar-item flexbox-left">
            <a class="navbar-item-inner flexbox-left">
              <div class="navbar-item-inner-icon-wrapper flexbox">
                <ion-icon name="folder-open-outline"></ion-icon>
              </div>
              <div class="link-text">
                <!-- <span class="nav-icon">‚ÑπÔ∏è</span>  -->
                <span  class="nav-text">M·ª•c B</span>
              </div>
            </a>
          </li>
          <li class="navbar-item flexbox-left">
            <a class="navbar-item-inner flexbox-left">
              <div class="navbar-item-inner-icon-wrapper flexbox">
                <ion-icon name="pie-chart-outline"></ion-icon>
              </div>
              <div class="link-text">
                <!-- <span class="nav-icon">‚ÑπÔ∏è</span>  -->
                <span  class="nav-text">M·ª•c C</span>
              </div>
            </a>
          </li>
          <li class="navbar-item flexbox-left">
            <a class="navbar-item-inner flexbox-left">
              <div class="navbar-item-inner-icon-wrapper flexbox">
                <ion-icon name="people-outline"></ion-icon>
              </div>
              <div class="link-text">
                <!-- <span class="nav-icon">‚ÑπÔ∏è</span>  -->
                <span  class="nav-text">M·ª•c D</span>
              </div>
            </a>
          </li>
          <li class="navbar-item flexbox-left">
            <a class="navbar-item-inner flexbox-left">
              <div class="navbar-item-inner-icon-wrapper flexbox">
                <ion-icon name="chatbubbles-outline"></ion-icon>
              </div>
              <div class="link-text">
                <!-- <span class="nav-icon">‚ÑπÔ∏è</span>  -->
                <span  class="nav-text">M·ª•c B</span>
              </div>
            </a>
          </li>
          <li class="navbar-item flexbox-left">
            <a class="navbar-item-inner flexbox-left" href="{{ url_for('logout') }}">
              <div class="navbar-item-inner-icon-wrapper flexbox">
                <ion-icon name="settings-outline"></ion-icon>
              </div>
              <div style="color: #fff;" class="link-text">
                <!-- <span class="nav-icon">üîí</span>  -->
                <span  class="nav-text">Logout</span>
              </div>
            </a>
          </li>
        </ul>
      </nav>
      <div class="container">
        <div  class="overlay-image" alt="overlay"></div>
        <header>
          <h3>DASHBOARD</h3>
          <h1 style="padding: 10px; display: inline;">Infomation screw machine</h1>
        </header>
        <div class="mainContent">
          <h1 style="padding: 10px;"></h1>
          <div class="content">
            <div class="content-top">
              
              <div class="info1" >
                <div class="infor">Total</div>
                <div class="card" style="color: #fff; " id="total-records">N/A</div>
                <div class="glow-line"></div>
              </div>
              <div class="info1" >
                <div class="infor">Pass</div>
                <div class="card" style="color: rgb(2, 255, 158); " id="pass-records">N/A</div>
                <div class="glow-line"></div>
              </div>
              <div class="info1" >
                <div class="infor">Fail</div>
                <div class="card" style="color: rgb(247, 68, 68); " id="fail-records">N/A</div>
                <div class="glow-line"></div>
                </div>
              <div class="info1" >
                <div class="infor" >FPY</div>
                <div class="card" style="color: #fff;" id="fpy-percentage">N/A</div>
                <div class="glow-line"></div>
                </div>
              <div class="dowfile">
                <a id="download-excel"><span><img style="width: 32px; height: 32px; " src="{{ url_for('static', filename='images/download.png') }}"  alt="Expoprt File"></span></a>
              </div>
            </div>
            <div class="tbl-header">
              <table  cellpadding="0" cellspacing="0" border="0">
                <thead>
                  <tr>
                    <th>STT</th>
                    <th>FACTORY</th>
                    <th>LINE</th>
                    <th>NAME MACHINE</th>
                    <th>MODEL NAME</th>
                    <th>SERIAL NUMBER</th>
                    <th>FORCE 1</th>
                    <th>FORCE 2</th>
                    <th>FORCE 3</th>
                    <th>FORCE 4</th>
                    <th>TIME</th>
                    <th>STATE</th>
                  </tr>
                </thead>
              </table>
            </div>
            <div class="tbl-content">
              <table id="result-table" cellpadding="0" cellspacing="0" border="0">
                <tbody id="table-body">
                </tbody>
              </table>
            </div>
            <!-- filter -->
            <div class="filter">
            Factory: <select id="factory-combobox">
            </select>
            Line: <select id="line-combobox">
            </select>
            Name machine: <select id="nameMachine-combobox" style="width: 80px;"></select>
            Time: <input style="width: 180px; border-radius: 2px;"  type="datetime-local" name="time_update" id="time_update">
            To: <input style="width: 180px; border-radius: 2px;"  type="datetime-local" name="time_end" id="time_end">
            State: <select id="state-combobox">
            </select>
              <input style=" transition: all .5s ease-in-out; padding: 0.5em; width: 5em; " type="submit" value="Search" id="filter">
            </div>
            <div id="count"></div>
          </div>
          <div class="modeFullScreen">
            <a href="#" id="toggle_fullscreen">
              <img
                id="fullscreenic"
                src="/static/images/fullscreen1.png"
                alt="Fullscreen Icon"
              />
            </a>
          </div>     
        <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
        <div class="chartAll">
          <div class="chartContent">
            <div class="pagination"  id="pagination">
            </div>
            <div class="pieChartInfo">
              <figure class="highcharts-figure">
                <div id="container-pie"></div>
              </figure>
              <script>
                Highcharts.chart('container-pie', {
                    chart: {
                        type: 'pie',
                        backgroundColor: null,
                        plotBackgroundColor:null
                    },                    
                    title: {
                        text: 'Rate Pass/Fail By Day',
                        align:'left',
                        style:{
                          color: '#fff',
                          fontSize: '16px',
                        }
                    },
                    accessibility: {
                        announceNewData: {
                            enabled: true
                        },
                        point: {
                            valueSuffix: '%'
                        }
                    },
                    credits:false,
                    plotOptions: {
                        series: {
                            borderRadius: 5,
                            dataLabels: [{
                                enabled: true,
                                distance: 15,
                                format: '{point.name}'
                            },
                             {
                                enabled: true,
                                distance: '-30%',
                                filter: {
                                    property: 'percentage',
                                    operator: '>',
                                    value: 5                                    
                                },
                                format: '{point.y:.1f}%',
                                style: {
                                  fontSize: '1em',
                                  color: '#fff',
                                  textOutline: 'none'
                                }
                            }]
                        }
                    },
                    tooltip: {
                        headerFormat: '<span style="font-size:12px">{series.name}</span><br>',
                        pointFormat: '<span style="color:{point.color}">{point.name}</span>: ' +
                            '<b>{point.y:.2f}%</b> of total<br/>'
                    },
                    series: [
                        {
                            name: 'Rate',
                            colorByPoint: true,
                            data: [
                                {
                                    name: 'Pass',
                                    y: 61,
                                    drilldown: 'Pass',
                                    color: '#337cf2',
                                    dataLabels: {
                                    style: {
                                      color: '#fff', 
                                      fontSize: '16px',
                                      textOutline: 'none',
                                      fontWeight:'none'
                                    }
                                  }                                  
                                },
                                {
                                    name: 'Fail',
                                    y: 39,
                                    drilldown: 'Fail',
                                    color: '#dc3545',
                                    dataLabels: {
                                    style: {
                                      color: '#fff', 
                                      fontSize: '16px',
                                      textOutline:'none',
                                      fontWeight:'none'
                                    }
                                  }
                                }
                            ]
                        }
                    ],
                    drilldown: {
                        series: [
                            {
                                name: 'Pass',
                                id: 'Pass',
                                data: [
                                    [
                                        'XB7',
                                        35
                                    ],
                                    [
                                        'XB8',
                                        15
                                    ],
                                    [
                                        'XB8M',
                                        5
                                    ],
                                    [
                                        'XB7M',
                                        6
                                    ]
                                ]
                            },
                            {
                                name: 'Fail',
                                id: 'Fail',
                                data: [
                                    [
                                        'XB8',
                                       15
                                    ],
                                    [
                                        'XB8M',
                                        11
                                    ],
                                    [
                                        'XB7',
                                        12
                                    ],
                                    [
                                        'XB7M',
                                        1
                                    ]
                                ]
                            },                          
                        ]
                    }
                });
              </script>
            </div>
            <div class="chartRight">
              <div>
                  <figure class="highcharts-figure">
                      <div id="container-toperr"></div>
                  </figure>
                  <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        const dailyData = {
                            dates: ['01/02', '02/02', '03/02', '04/02', '05/02'],
                            machineA: [150, 142, 138, 145, 133],
                            machineB: [120, 125, 118, 130, 122],
                            machineC: [90, 95, 88, 92, 85]
                        };
                        const hourlyData = {
                        '01/02': {
                            hours: [...Array(24).keys()].map(i => `${i}h`),
                            machineA: [25, 28, 22, 26, 24, 25, 30, 28, 29, 27, 31, 26, 25, 24, 29, 27, 26, 25, 30, 29, 28, 27, 26, 25],
                            machineB: [20, 22, 18, 21, 19, 20, 22, 21, 23, 22, 24, 21, 20, 19, 23, 22, 21, 20, 22, 21, 23, 22, 21, 20],
                            machineC: [15, 16, 14, 15, 15, 15, 18, 16, 17, 15, 19, 16, 15, 14, 18, 17, 16, 15, 18, 17, 16, 15, 14, 15]
                        },
                        '02/02': {
                            hours: [...Array(24).keys()].map(i => `${i}h`),
                            machineA: [24, 23, 25, 24, 23, 23, 26, 25, 27, 24, 28, 23, 24, 22, 27, 26, 25, 24, 26, 25, 27, 26, 25, 24],
                            machineB: [21, 20, 22, 21, 20, 21, 23, 22, 24, 21, 25, 20, 21, 19, 24, 23, 22, 21, 23, 22, 24, 23, 22, 21],
                            machineC: [16, 15, 17, 16, 15, 16, 19, 17, 18, 16, 20, 17, 16, 14, 19, 18, 17, 16, 19, 18, 17, 16, 15, 16]
                        },
                        '03/02': {
                            hours: [...Array(24).keys()].map(i => `${i}h`),
                            machineA: [23, 22, 24, 23, 23, 23, 25, 24, 26, 23, 27, 22, 23, 21, 26, 25, 24, 23, 25, 24, 26, 25, 24, 23],
                            machineB: [20, 19, 21, 20, 19, 19, 22, 21, 23, 20, 24, 19, 20, 18, 23, 22, 21, 20, 22, 21, 23, 22, 21, 20],
                            machineC: [15, 14, 16, 15, 14, 14, 17, 15, 16, 14, 18, 15, 14, 13, 17, 16, 15, 14, 17, 16, 15, 14, 13, 14]
                        },
                        '04/02': {
                            hours: [...Array(24).keys()].map(i => `${i}h`),
                            machineA: [24, 25, 23, 24, 25, 24, 27, 26, 28, 25, 29, 24, 25, 23, 28, 27, 26, 25, 27, 26, 28, 27, 26, 25],
                            machineB: [22, 21, 22, 22, 21, 22, 24, 23, 25, 22, 26, 21, 22, 20, 25, 24, 23, 22, 24, 23, 25, 24, 23, 22],
                            machineC: [15, 16, 15, 15, 16, 15, 18, 16, 17, 15, 19, 16, 15, 14, 18, 17, 16, 15, 18, 17, 16, 15, 14, 15]
                        },
                        '05/02': {
                            hours: [...Array(24).keys()].map(i => `${i}h`),
                            machineA: [22, 21, 23, 22, 23, 22, 25, 24, 26, 22, 27, 21, 22, 20, 26, 25, 24, 22, 25, 24, 26, 25, 24, 22],
                            machineB: [20, 21, 20, 21, 20, 20, 23, 22, 24, 21, 25, 20, 21, 19, 24, 23, 22, 20, 23, 22, 24, 23, 22, 20],
                            machineC: [14, 15, 14, 14, 14, 14, 17, 15, 16, 14, 18, 15, 14, 13, 17, 16, 15, 14, 17, 16, 15, 14, 13, 14]
                        }
                    };

                        Highcharts.chart('container-toperr', {
                            chart: {
                                type: 'column',
                                backgroundColor: null,
                                plotBackgroundColor: null,
                                events: {
                                    drilldown: function (e) {
                                        if (!e.seriesOptions) {
                                            const date = e.point.category;
                                            const machine = e.point.series.name;
        
                                            if (!hourlyData[date]) return;
        
                                            const machineKey = machine === 'M√°y A' ? 'machineA' : machine === 'M√°y B' ? 'machineB' : 'machineC';
        
                                            this.xAxis[0].setCategories(hourlyData[date].hours);
                                            this.setTitle({ text: `Detail Fail ${machine} day ${date}` });
        
                                            this.addSeriesAsDrilldown(e.point, {
                                                name: machine,
                                                data: hourlyData[date].hours.map((hour, i) => [hour, hourlyData[date][machineKey][i]]),
                                                color: e.point.color
                                            });
        
                                            this.applyDrilldown();
                                        }
                                    },
                                    drillup: function () {
                                        this.xAxis[0].setCategories(dailyData.dates); 
                                        this.setTitle({ text: 'Top 3 Machine Fail' });
                                    }
                                }
                            },
                            title: {
                                text: 'Top 3 Machine Fail',
                                align: 'left',
                                style: { color: '#fff', fontSize: '16px', fontWeight: 'bold' }
                            },
                            xAxis: {
                                categories: dailyData.dates,
                                title: { text: 'Day', style: { color: '#fff', fontSize: '12px' } },
                                labels: { style: { color: '#fff', fontSize: '12px' } },
                                
                            },
                            yAxis: {
                                min: 0,
                                title: { text: 'Count Fail', style: { color: '#fff', fontSize: '12px' } },
                                labels: { style: { color: '#fff', fontSize: '12px' } }
                            },
                            tooltip: {
                                shared: true,
                                useHTML: true
                            },
                            plotOptions: {
                                column: {
                                    groupPadding: 0.1,
                                    states: { hover: { brightness: 0.2 } }
                                },
                                series: { cursor: 'pointer' }
                            },
                            series: [
                                {
                                    name: 'M√°y A',
                                    data: dailyData.machineA.map((value, i) => ({ name: dailyData.dates[i], y: value, drilldown: true })),
                                    color: '#FF6B6B'
                                },
                                {
                                    name: 'M√°y B',
                                    data: dailyData.machineB.map((value, i) => ({ name: dailyData.dates[i], y: value, drilldown: true })),
                                    color: '#4ECDC4'
                                },
                                {
                                    name: 'M√°y C',
                                    data: dailyData.machineC.map((value, i) => ({ name: dailyData.dates[i], y: value, drilldown: true })),
                                    color: '#45B7D1'
                                }
                            ],
                            drilldown: {
                              series: [],
                              breadcrumbs: {
                                  position: {
                                      align: 'left'
                                  },
                                  style: {
                                      color: '#fff',
                                      fontSize: '16px',
                                      fontWeight: 'bold',
                                      textDecoration: 'underline' 
                                  },
                              }
                          },
                            credits: { enabled: false },
                            legend: {
                            align: 'center',
                            verticalAlign: 'bottom',
                            itemStyle:{
                              color: '#fff'
                            },
                            itemHoverStyle: {
                            color: '#cccccc'
                          }
                          }
                        });
                    });
                </script>
              </div>
          </div>          
          </div>
          <div class="chartCotent1">
            <div class="chartColumn">
                <figure class="highcharts-figure">
                  <div id="container3"></div>
                </figure>
                <script>
                  Highcharts.chart('container3', {
                    chart: {
                      zooming: {
                        type: 'x'
                      },
                      backgroundColor: null,
                      plotBackgroundColor:null
                    },
                    title: {
                      text: 'Screw Force Trend',
                      align: 'left',
                       style: {
                          color: '#fff', 
                          fontSize: '16px', 
                          fontWeight: 'bold'
                        }
                    },
                    credits: {
                      enabled: null
                    },
                  accessibility:{
                    enabled: false
                  },
                    xAxis: [{
                      categories: [
                        '10/1/2025', '11/1/2025', '12/1/2025', '13/1/2025', '14/1/2025', '15/1/2025'
                      ],
                      crosshair: true,
                      labels: {
                        style: {
                          color: '#fff', 
                          fontSize: '12px'
                        }
                      }
                      
                    }],
                    yAxis: [{ 
                      labels: {
                        format: '{value}¬∞%',
                        style: {
                          color: '#fff'
                        }
                      },
                      title: {
                        text: 'FPY',
                        style: {
                          color: '#fff'
                        }
                      }
                    }, { 
                      title: {
                        text: 'Count',
                        style: {
                          color: '#fff'
                        }
                      },
                      labels: {
                        format: '{value}',
                        style: {
                          color: '#fff'
                        }
                      },
                      opposite: true
                    }],
                    tooltip: {
                      shared: true
                    },
                    legend: {
                      align: 'center',
                      verticalAlign: 'bottom',
                      itemStyle:{
                        color: '#fff'
                      },
                      itemHoverStyle: {
                      color: '#cccccc'
                    }
                    },
                    series: [{
                      name: 'Pass',
                      type: 'column',
                      yAxis: 1,
                      data: [
                        45.7, 37.0, 28.9, 17.1, 39.2, 18.9
                      ],
                      tooltip: {
                        valueSuffix: ''
                      }
                    }, {
                      name: 'Fail',
                      type: 'column',  
                      yAxis: 1,
                      data: [
                        54.3, 63.0, 71.1, 82.9, 60.8, 81.1
                      ],
                      tooltip: {
                        valueSuffix: ''
                      }
                    }, {
                      name: 'FPY',
                      type: 'spline', 
                      data: [
                        45.7, 37.0, 28.9, 17.1, 39.2, 18.9
                      ],
                      tooltip: {
                        valueSuffix: ' %'
                      }
                    }]
                  });
                </script>              
            </div>
            <div class="chartColumn2">
              <figure class="highcharts-figure">
                <div id="container"></div>
              </figure>
              <script>
                Highcharts.chart('container', {
                  chart: {
                    type: 'line',
                    backgroundColor:null
                  },
                  
                  title: {
                    text: 'Chart CPK',
                    align:'left',
                    style:{
                      color: '#fff', 
                      fontSize: '16px', 
                      fontWeight: 'bold'
                    }
                  },
                  xAxis: {
                    categories: ['Machine 1', 'Machine 2', 'Machine 3', 'Machine 4', 'Machine 5', 'Machine 6', 'Machine 7', 'Machine 8', 'Machine 9'],
                    labels: {
                      style: {
                        color: '#ffffff' 
                      }
                    },
                    title: {
                      text: 'Machine Name', 
                      style: {
                        color: '#fff'
                      }
                    }
                  },
                  credits:{
                    enabled:null
                  },
                  legend: {
                      align: 'center',
                      verticalAlign: 'bottom',
                      itemStyle:{
                        color: '#fff'
                      },
                      itemHoverStyle: {
                      color: '#cccccc'
                    }
                  },                  
                  accessibility:{
                    enabled: false
                  },
                  yAxis: {
                    title: {
                      text: 'Force Screw',
                      style:{
                        color:'#fff'
                      }
                    },
                    labels: {
                    style: {
                        color: '#ffffff' 
                    }
                  },
                  },
                  series: [
                    {
                      type: 'line',
                      name: 'AVG force 1',
                      data: [7.7, 8, 10, 8.5, 9, 9.5, 8.2, 7.7, 10.6],
                      zIndex: 1
                    },
                    {
                      type: 'line',
                      name: 'AVG force 2',
                      data: [9.5, 8.5, 9.1, 7.3, 8.2, 9.8, 8.7, 6.9, 7.1],
                      zIndex: 1
                    },
                    {
                      type: 'line',
                      name: 'AVG force 3',
                      data: [11.8, 7.1, 9.2, 9.6, 7.1, 8.3, 8.4, 7.6, 9.3],
                      zIndex: 1
                    },
                    {
                      type: 'line',
                      name: 'AVG force 4',
                      data: [7.6, 8.3, 7.5, 6.4,7.9, 8.4, 8.1, 11.5, 10.2],
                      zIndex: 1
                    },
                    {
                      type: 'line',
                      name: 'UCL',
                      data: Array(9).fill(11), 
                      dashStyle: 'Solid',
                      color: 'red',
                      zIndex: 2
                    },
                    {
                      type: 'line',
                      name: 'LCL',
                      data: Array(9).fill(7), 
                      dashStyle: 'Solid',
                      color: 'blue',
                      zIndex: 2
                    },
                    {
                      type: 'line',
                      name: 'AVG',
                      data: Array(9).fill(9), 
                      dashStyle: 'Dot',
                      color: 'green',
                      zIndex: 3
                    }
                  ]
                });
              </script>
            </div>
          </div>
          <div class="chartContent2">
            <!-- <div class="chart3">
              <h1>ABC</h1>
            </div>
            <div class="chart4">
              <h1>DEF</h1>
            </div> -->
          </div>
        </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
